<!DOCTYPE html>
<html>
<head>
    <title>Soundfont CDN Test</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        .test { margin: 10px 0; }
        .success { color: green; }
        .error { color: red; }
        .pending { color: orange; }
    </style>
</head>
<body>
    <h1>Soundfont CDN Sources Test</h1>
    <div id="results"></div>
    
    <script>
        const results = document.getElementById('results');
        
        // Test different CDN sources
        const cdnSources = [
            {
                name: "jsDelivr (gleitz/midi-js-soundfonts)",
                base: "https://cdn.jsdelivr.net/gh/gleitz/midi-js-soundfonts@gh-pages/FluidR3_GM",
                testPath: "trumpet-mp3/C4.mp3"
            },
            {
                name: "jsDelivr Alternative",
                base: "https://cdn.jsdelivr.net/gh/gleitz/midi-js-soundfonts/FluidR3_GM",
                testPath: "trumpet-mp3/C4.mp3"
            },
            {
                name: "GitHub Raw",
                base: "https://raw.githubusercontent.com/gleitz/midi-js-soundfonts/gh-pages/FluidR3_GM",
                testPath: "trumpet-mp3/C4.mp3"
            },
            {
                name: "unpkg",
                base: "https://unpkg.com/midi-js-soundfonts/FluidR3_GM",
                testPath: "trumpet-mp3/C4.mp3"
            }
        ];
        
        // Test each CDN source
        async function testCDNSources() {
            for (const source of cdnSources) {
                const testUrl = `${source.base}/${source.testPath}`;
                const resultDiv = document.createElement('div');
                resultDiv.className = 'test pending';
                resultDiv.textContent = `Testing ${source.name}: ${testUrl}`;
                results.appendChild(resultDiv);
                
                try {
                    const response = await fetch(testUrl, { method: 'HEAD' });
                    if (response.ok) {
                        resultDiv.className = 'test success';
                        resultDiv.textContent += ` ✓ SUCCESS (${response.status})`;
                    } else {
                        resultDiv.className = 'test error';
                        resultDiv.textContent += ` ✗ FAILED (${response.status})`;
                    }
                } catch (error) {
                    resultDiv.className = 'test error';
                    resultDiv.textContent += ` ✗ ERROR: ${error.message}`;
                }
            }
        }
        
        // Test Tone.js Sampler directly
        async function testToneSampler() {
            const resultDiv = document.createElement('div');
            resultDiv.className = 'test pending';
            resultDiv.textContent = 'Testing Tone.js Sampler loading...';
            results.appendChild(resultDiv);
            
            // Load Tone.js
            const script = document.createElement('script');
            script.src = 'https://unpkg.com/tone@14.8.49/build/Tone.js';
            script.onload = async () => {
                await Tone.start();
                
                try {
                    // Try to create a sampler with a simple URL set
                    const sampler = new Tone.Sampler({
                        urls: {
                            C4: "https://cdn.jsdelivr.net/gh/gleitz/midi-js-soundfonts@gh-pages/FluidR3_GM/acoustic_grand_piano-mp3/C4.mp3"
                        }
                    });
                    
                    // Wait for loading
                    await new Promise((resolve, reject) => {
                        const checkLoaded = () => {
                            if (sampler.loaded) {
                                resolve();
                            } else {
                                setTimeout(checkLoaded, 100);
                            }
                        };
                        setTimeout(() => reject(new Error('Timeout')), 5000);
                        checkLoaded();
                    });
                    
                    resultDiv.className = 'test success';
                    resultDiv.textContent += ' ✓ Tone.js Sampler loaded successfully';
                    
                } catch (error) {
                    resultDiv.className = 'test error';
                    resultDiv.textContent += ` ✗ Tone.js Sampler failed: ${error.message}`;
                }
            };
            document.head.appendChild(script);
        }
        
        // Run tests
        testCDNSources().then(() => {
            const divider = document.createElement('div');
            divider.innerHTML = '<hr><h2>Tone.js Test</h2>';
            results.appendChild(divider);
            testToneSampler();
        });
    </script>
</body>
</html>
