<!DOCTYPE html>
<html>
<head>
    <title>GM Instruments Fix Test</title>
</head>
<body>
    <h1>Testing GM Instruments Fix</h1>
    <div id="test-results"></div>
    
    <script type="module">
        import jm from '../dist/jmon.esm.js';
        
        const results = document.getElementById('test-results');
        
        function log(message) {
            const p = document.createElement('p');
            p.textContent = message;
            results.appendChild(p);
        }
        
        log('Testing GM instruments note naming...');
        
        try {
            // Create a simple composition 
            const testComposition = {
                meta: { title: "Test" },
                bpm: 120,
                tracks: [{
                    label: "Test Track",
                    notes: [{ pitch: 22, time: 0, duration: 1 }] // MIDI 22 = Bb0
                }]
            };
            
            // Create player - this should trigger GM instrument URL generation
            const player = jm.play(testComposition, { Tone: window.Tone });
            
            log('✅ GM instruments player created successfully - no "As0" error!');
            
            // Try changing to Drawbar Organ specifically (the problematic instrument from error)
            document.body.appendChild(player);
            
        } catch (error) {
            log('❌ Error: ' + error.message);
            console.error('Detailed error:', error);
        }
    </script>
    
    <script src="https://unpkg.com/tone@14.8.49/build/Tone.js"></script>
</body>
</html>
